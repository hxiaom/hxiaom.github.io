---
layout: post
title: 【Method】k近邻法
categories: Analytics
---

## 原理

k近邻法（k-nearest neighbor，k-NN）是一种基本的分类与回归方法。此处只讨论分类问题中的k-NN算法。k-NN算法的输入为实例的特征向量，对应于特征空间的点；输出为实例的类别。可以取多类。k近邻法假设给定一个训练数据集，其中的实例类别已定。分类时，对于新的实例，根据其k个最近邻的训练实例的类别，通过多数表决等方法进行预测。因此，k近邻法不具有显示的学习过程。k近邻法实际上利用训练数据集对特征向量空间进行划分，并作为其分类的“模型”。k值的选择、距离度量及分类决策规则是k近邻法的三个基本要素。k近邻法1968年由Cover和Hart提出。

k近邻算法简单、直观：给定一个训练数据集，对新的输入实例，在训练数据集中找到与该实例最邻近的k个实例，这k个实例的多数属于某个类，就把该输入实例分为这个类。

算法：k近邻法

输入：训练数据集

$$T = {(x_1, y_1), (x_2, y_2),...,(x_N, y_N)}$$

其中，$$x_i \in X \subseteq R^n$$为实例的特征向量，$$y_i \in Y = {c_1, c_2,...,c_K}$$为实例的类别，i=1,2,...,N；实例特征向量x；

输出：实例x所属的类y

(1) 根据给定的距离度量，在训练集T中找出与x最邻近的k个点，涵盖着k个点的x的邻域记作$$N_k(x)$$；

(2) 在$$N_k(x)中根据分类决策规则（如多数表决）决定x的类别y：

$$y = arg max_{c_j} \sum_{x_i \in N_k(x)} I(y_i = c_i), i=1,2,...,N; j=1,2,...,K$$

上式中，I为指示函数，即当$$y_i = c_i$$时，I为1，否则I为0.

k近邻法的特殊情况是k=1的情形，称为最近邻算法。对于输入的实例点（特征向量）x，最近邻将训练数据集中与x最邻近点的类作为x的类。

k近邻算法没有显式的学习过程。

### k近邻模型

k近邻法使用的模型实际上对应于对特征空间的划分。模型由三个基本要素——距离度量、k值的选择和分类决策规则决定。

#### 模型

k近邻法中，当训练集、距离度量（如欧氏距离）、k值及分类决策规则（如多数表决）确定后，对于任何一个新的输入实例，它所属的类唯一地确定。这相当于根据上述要素将特征空间划分为一些子空间，确定子空间里的每个点所属的类。这一事实从最近邻算法中可以看得很清楚。

特征空间中，对于每个训练实例点$$x_i$$，距离该点比其他点更近的所有点组成一个区域，叫做单元（cell）。每个训练实例点拥有一个单元，所有训练实例点的单元构成对特征空间的一个划分。最近邻算法将实例$$x_i$$的类$$y_i$$作为其单元中所有点的类标记（class label）。这样，每个单元的实例点的类别是确定的。

#### 距离度量

特征空间中两个实例点的距离是两个实例点相似程度的反映。k近邻模型的特征空间一般是n维实数向量空间$$R^n$$。使用的距离是欧氏距离，但也可以是其他距离，如更一般的$$L_p$$距离($$L_p$$ distance)或Minkowski距离（Minkowski distance）。

