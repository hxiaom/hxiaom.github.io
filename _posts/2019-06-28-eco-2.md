---
layout: post
title: 【Method】计量导论（二）概率论知识回顾
categories: Analytics
---

本章所包含的概率论知识是理解回归分析和计量经济学的基础。

## 随机变量和概率分布

### 概率、样本空间和随机变量

随机事件的每个互斥的可能后果被称为结果（outcomes）。

结果发生的概率（probability）是指某一个结果在长期内发生次数的比例或频率。

样本空间和事件。所有可能结果的集合被称为样本空间（sample space）。一个事件（event）是样本空间的一个子集，换言之，一个事件是由一个或多个结果组成的集合。

随机变量。一个随机变量是一个随机结果的数值描述。

离散型随机变量（discrete random variable）只取离散值，如0、1、2等；而连续型随机变量（continuous random variable）则可以取连续的值。

### 离散型随机变量的概率分布

概率分布。离散型随机变量的概率分布（probability distribution）是指由变量的所有可能取值及其对应的发生概率所组成的列表。所有取值的概率之和等于1。

事件的概率。根据概率分布可以计算出一个事件发生的概率。

累积概率分布。累积概率分布（cumulative probability distribution）是指随机变量的取值小于或等于某一特定值的概率。

累积概率分布也可称为累积分布函数（cumulative distribution function），或累积分布（cumulative distribution）。

伯努利分布。离散型随机变量的一个重要特例是随机变量为二元变量的情形，即其结果只有0或1两种。一个二元随机变量被称为伯努利随机变量（Bernoulli random variable），这一随机变量的概率分布被称为伯努利分布（Bernoulli distribution）。

### 连续型随机变量的概率分布

累积概率分布。一个连续型随机变量的累积概率分布的定义与离散型随机变量相同，即连续型随机变量的累积概率分布为该随机变量小于或等于某个特定值的概率。

概率密度函数。因为连续型随机变量取连续值，从而无法像离散型随机变量那样列出所有可能取值的概率。因此，可以用概率密度函数（probability density function）表示连续型随机变量的概率，即用概率密度函数下方区域的面积来表示随机变量落入两点之间的概率。概率密度函数也称为p.d.f、密度函数（density function）、或简称为密度（density）。

## 期望值、均值和方差

### 随机变量的期望值

期望值。随机变量Y的期望值（expected value），记作E(Y)，是指随机变量经过若干次重复实验所得到的长期平均值。离散型随机变量的期望值等于随机变量所有可能结果的加权平均值，权重为每一结果出现的概率。Y的期望值也称为Y的期望（expectation）或Y的均值（mean），记作$$\mu_Y$$。

- 伯努利随机变量的期望值
- 连续型随机变量的期望值

### 标准差与方差

标准差与方差度量的是概率分布的离散或“偏差”程度。随机变量Y的方差（variance）记作Var(Y)，是Y与其均值的偏差平方的期望值，即$$Var(Y)=E[(Y-\mu_Y)^2]$$

因为方差包含了Y的平方，所以方差的单位便是Y平方的单位，这使得方差解释起来显得有些奇怪。因此，通常用标准差（standard deviation），即方差的平方根来度量偏差程度，记作$$\sigma_Y$$。标准差与Y的单位一致。

- 伯努利随机变量的方差

### 随机变量线性函数的均值和方差

$$\begin{align} 
Y &= a + bX \\
\mu_Y &= a + b\mu_X \\
\sigma_Y^2  = b^2\sigma_X^2 \\
\end{align}$$

### 分布形态的其他度量指标

偏度（用来度量分布的非对称性）和峰度（度量分布尾部粗细或厚薄特征）。均值、方差、偏度、峰度都是基于分布的矩（moments of a distribution）来定义的。

随机变量Y的分布的偏度（skewness）为

$$skewness = \frac{E[(Y-\mu_Y)^3]}{\sigma_Y^3}$$

分子$$Y^3$$和分母$$\sigma_Y^3$$的单位相互抵消，从而偏度是无量纲的。换言之，改变Y的单位不会改变其偏度。

分布的峰度（kurtosis）是度量其尾部厚薄程度的指标。因此，它衡量了Y的方差在多大程度上是由其极端值引起的。Y的极端值称为异常值（outlier）。分布的峰度越大，出现异常值的可能性越高。

Y的分布的峰度为

$$kurtosis = \frac{E[(Y-\mu_Y)^4]}{\sigma_Y^4}$$

正态分布的随机变量的峰度为3，所以对一个峰度超过3的随机变量，其尾部厚度一定大于正态分布随机变量。峰度超过3的分布被称为尖峰（leptokurtic），或简称为厚尾。如同偏度一样，峰度同样是无量纲的，所以改变Y的单位不会影响其峰度。

矩。Y的均值E(Y)，通常被称为Y的一阶矩。而Y的平方的期望值，即$$E(Y^2)$$，被称为Y的二阶矩。通常来说，$$Y^r$$的期望值被称为随机变量Y的第r阶矩（r-th moment)。换言之，Y的r阶矩为$$E(Y^r)$$。偏度是随机变量Y的一阶矩、二阶矩、三阶矩的函数，而峰度是Y的一阶矩至四阶矩的函数。

## 二维随机变量

大多数我们感兴趣的经济问题通常涉及两个或两个以上的随机变量。

### 联合分布和边缘分布

联合分布。两个离散型随机变量（如X和Y）的联合概率分布（joint probability distribution）是指这两个变量同时取某些确定的值（如x和y）的概率。所有可能的(x,y)组合的概率相加等于1.联合概率分布可以表示为函数$$Pr(X=x,Y=y)$$。

边缘概率分布。随机变量Y的边缘概率分布（marginal probability distribution）是其概率分布的另一种表述形式。这一术语用于区分单个随机变量Y的分布（边缘分布）及Y与其他随机变量的联合分布。

Y的边缘概率分布可以通过X和Y的联合分布计算得出，即Y取某个特定值时存在的所有可能结果概率的加总。如果X有l种不同的取值，则Y取y时的边缘概率分布为：

$$P(Y=y) = \sum_{i=1}^l P(X=x, Y=y)$$

### 条件分布

条件分布。在给定随机变量X取某个值的条件下，另一随机变量Y的分布被称为给定X时Y的条件分布（conditional distribution）。当X取x值时，Y取y值的条件概率记作$$P(Y=y \mid X=x)$$。

$$P(Y=y \mid X=x) = \frac{P(Y=y, X=x)}{P(X=x)}$$

条件期望。给定X的取值，Y的条件期望（conditional expectation）也被称为给定X时Y的条件均值（conditional mean），是指当X取某一特定值时，Y的条件分布的平均值。也就是说，条件期望是指给定X值时Y的期望值，可以通过Y的条件分布计算得到。如果Y有k种取值，则给定X=x时Y的条件均值为

$$E(Y \mid X=x) = \sum_{i=1}^k y_i P(Y=y_i \mid X=x)$$

期望迭代法则。Y的均值等于给定X时Y的条件期望的加权平均值，权重为X的概率分布。

$$E(Y) = \sum_{i=1}^l E(Y \mid X=x_i)P(X = x_i)$$

换言之，Y的期望是给定X时Y的条件期望的期望，即

$$E(Y) = E[E(Y \mid X)]$$

上式通常称为期望迭代法则（law of iterated expectation）。

条件方差。给定X时Y的方差是指给定X时Y的条件分布的方差。换句话说，给定X时Y的条件方差（conditional variance）为

$$Var(Y \mid X=x) = \sum_{i=1}^k [y_i - E(Y \mid X=x)]^2 P(Y=y_i \mid X=x)$$

### 独立性

若两个随机变量X和Y中某一个变量的取值无法提供关于另一个变量取值的相关信息，则这两个变量是独立分布的，或者说两个变量是独立的。特别地，如果给定X时Y的条件分布与Y的边缘分布相等，则X和Y是独立的。换言之，如果X和Y是独立分布的，则对于x和y所有取值来说，有

$$P(Y=y \mid X=x) = P(Y=y)$$

即如果X和Y是独立的，则

$$P(Y=y,X=x) = P(X=x)P(Y=y)$$

也就是说，两个独立随机变量的联合分布等于它们边缘分布的乘积。

### 协方差与相关系数

协方差是一种用来度量两个随机变量同时变动程度的指标。X与Y的协方差（covariance）是指期望值$$E[(X- \mu_X)(Y- \mu_Y)]$$，其中$$\mu_X$$是X的均值，$$\mu_Y$$是Y的均值。协方差可以记作Cov(X,Y)或者$$\sigma_{xy}$$。如果X可以取1个值，而Y可以取k个值，则协方差可以通过以下公式计算：

$$\begin{align}
Cov(X,Y) &= \sigma_{xy} = E[(X- \mu_X)(Y - \mu_Y)] \\
&= \sum_{i=1}^k \sum_{j=1}^l (x_j - \mu_X)(y_i - \mu_Y) P(X=x_j, Y=y_i) \\
\end{align}$$

如果X和Y向相同方向变动，则协方差为正，反之为负。如果X和Y是独立的，则协方差为零。

相关系数。由于X和Y的协方差是X和Y对它们均值偏离程度的乘积，从而协方差的单位是X的单位乘以Y的单位。而相关系数是衡量X和Y之间独立程度的另一个指标，它解决了协方差的“单位”问题。具体而言，X与Y的相关系数（correlation）是X和Y的协方差除以它们的标准差

$$corr(X,Y) = \frac{Cov(X,Y)}{\sqrt{Var(X) Var(Y)}} = \frac{\sigma_{XY}}{\sigma_X \sigma_Y}$$

上式中分子与分母单位相同，从而被消去单位的相关系数是无量纲的。如果corr(X,Y)=0，则称随机变量X和Y是不相关的（uncorrelated）。相关系数总是介于-1和1之间。

相关系数与条件均值。如果Y的条件均值不依赖于X，则Y和X是不相关的，即

$$如果E(Y \mid X) = \mu_Y，则Cov(Y,X) = 0，同时corr(X,Y)=0$$

然而，上述结论反过来不一定成立，即当X和Y不相关时，给定X时Y的条件均值不依赖于X的结论不一定成立。换句话说，Y的条件均值有可能是X的函数，但Y与X不相关。

### 随机变量之和的均值与方差

## 正态分布、$$\chi^2$$分布、学术t分布及F分布

在计量经济学中，最常见的概率分布是正态分布、$$\chi^2$$分布、学术t分布及F分布

### 正态分布

服从正态分布（normal distribution）的连续型随机变量具有钟型概率密度曲线。均值为$$\mu$$、方差为$$\sigma^2$$的正态分布概率曲线是关于均值对称的，且落入$$\mu-1.96\sigma$$与$$\mu+1.96\sigma$$之间的概率为95%。

均值为$$\mu$$