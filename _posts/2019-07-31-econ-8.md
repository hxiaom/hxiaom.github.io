---
layout: post
title: 【Method】回归分析基础（五）非线性回归函数
categories: Analytics
---

在之前的章节中，我们均假定总体回归函数是线性的，即总体回归函数的斜率是常数，因此X变化1个单位对Y的影响并不依赖于X本身的取值。然而，当X的变化对Y的影响依赖于一个或多个解释变量的取值时，情况会怎样？在这种情形下，总体回归函数是非线性的。

本章将介绍两类建立非线性回归模型的方法。其中，第一类适合用于解释变量$$X_1$$的变化对Y的影响依赖于$$X_1$$本身取值时的情形。第二类方法适用于解释变量$$X_1$$的变化对Y的影响依赖于$$X_2$$取值时的情形。

## 非线性回归的一般建模方法

本节将展示非线性回归建模的一般方法，该方法是将多元回归模型推广到非线性回归模型的情形，从而可利用前面章节的方法进行估计和检验。

### 非线性设定形式中X的变化对Y的影响

在固定其他解释变量$$X_2,...,X_k$$不变的情况下，当解释变量$$X_1$$变化$$\delta X_1$$时，被解释变量Y的变化是多少？当总体回归函数为线性时，该效应很容易计算，Y的变化为$$\delta Y = \beta_1 \delta X_1$$，其中$$\beta_1$$为$$X_1$$的总体回归系数。但当回归函数为非线性形式时，Y的预期变化依赖于解释变量的取值，从而其计算较为复杂。

非线性回归函数的一般公式。本章中所讨论的非线性回归模型具有如下形式。

$$Y_i = f(X_{1i}, X_{2i},...,X_{ki}) + u_i, i=1,...,n$$

其中，$$f(X_{1i}, X_{2i},...,X_{ki})$$为非线性回归函数（nonlinear regression function），它是解释变量$$X_{1i}, X_{2i}, ..., X_{ki}$$的非线性函数，$$u_i$$为误差项。例如，总体回归函数为$$f(Income_i) = \beta_0 + \beta_1 Income_i + \beta_2 Income_i^2$$

由于总体回归函数是给定$$X_{1i}, X_{2i}, ..., X_{ki}$$时$$Y_i$$的条件期望，因此上式考虑到了该条件期望是$$X_{1i}, X_{2i}, ..., X_{ki}$$的非线性函数的可能性，即$$E(Y_i \mid X_{1i}, X_{2i}, ..., X_{ki}) = f(X_{1i}, X_{2i}, ..., X_{ki})$$，其中f可能是非线性函数。如果总体回归函数是线性的，则$$f(X_{1i}, X_{2i}, ..., X_{ki}) = \beta_0 + \beta_1 X_{1i} + \beta_2 X_{2i} + ... + \beta_k X_{ki}$$，即将上式转化为线性回归模型。但是，上式也可能为非线性回归函数。

$$X_1$$变化对Y的影响。在控制其他解释变量$$X_2, ..., X_k$$不变的情形下，$$X_1$$变化$$\delta X_1$$时对Y的影响为解释变量分别取$$X_1 + \delta X_1, X_2, ..., X_k$$和$$X_1, X_2, ..., X_k$$的Y的期望值之差。