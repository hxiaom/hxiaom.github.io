---
layout: post
title: 【Paper】Taxi or Hitchhiking - Predicting Passenger’s Preferred Service on Ride Sharing Platforms
categories: Mobility
---

Lingyu Zhang1, Wei Ai2,∗, Chuan Yuan3,∗, Yuhui Zhang4,∗, Jieping Ye1. 2018. Taxi or Hitchhiking: Predicting Passenger’s Preferred Service on Ride Sharing Platforms. In SIGIR ’18: The 41st International ACM SIGIR Conference on Research & Development in Information Retrieval, July 8– 12, 2018, Ann Arbor, MI, USA. ACM, New York, NY, USA, 4 pages. https: //doi.org/10.1145/3209978.3210153

## Motivation

Ride sharing apps like Uber and Didi Chuxing have played an important role in addressing the users’ transportation needs, which come not only in huge volumes, but also in great variety. While some users prefer low-cost services such as carpooling or hitchhik- ing, others prefer more pricey options like taxi or premier services. Further analyses suggest that such preference may also be associ- ated with different time and location.

## Research gap

Our work is related to prediction and recommendation problems in transportation systems, especially in modeling the travel need of the passengers. Yet existing works focus more on the destination prediction [5, 8] and demand prediction [4]. The most relevant work is [8], which focuses on the prediction of the destination based on spatio-temporal contexts.

## Background

Our analysis is conducted in Didi Chuxing 3, which provides world-leading ride sharing services. The most popular four are:
- Express Express service offers the affordable mobility service where passengers can request for individual or pooled rides. Express made up more than 70% of the trips on RidsS.
- Premier Premier service offers high-end mobility experience with luxury vehicles and drivers trained with highest service standards.
- Taxi Taxi service works with city-registered taxis and sends passengers’ pickup requests to nearby taxis.
- Hitch Hitch provides a social carpooling platform that helps commuters find/provide carpool service to save the cost.


## Proposed Method

In this paper, we model users’ choice of services, and build classifiers to predict the user’s choice when opening the app. Intuitively, such choices are correlated with several features: (a) the services that the users have chosen in previous trips, and (b) the current time and location of the users.

Majority: Since Express service is the most affordable and accessi- ble among the four services, by majority guessing, we would predict Express for all trips. This trivial baseline would result in an accuracy of 0.72 and an F1-score of 0.21.

Local Majority: Although in the city level, the Express service is the most popular choice, the case can be different in different local areas. For example, in a high-end residential community or the CBD, most users would prefer the Premier service. Therefore, we implement a basic grid structure by partitioning the map in to 1 km2 square cells and calculate the most popular service in each cell to make prediction. We would then predict the local majority service to all trips within the same sell. This results in an accuracy of 0.74 and an F1-score of 0.31.


Individual Majority: 

### 4.1 Sequential Models

Last Used: The first model assumes that users will choose the same service as their last trip. 

### 4.2 Spatio-Temporal Model

Spatial Model: Although the grid structure greatly reduces the entropy in the training set, creating a “Cell Majority” model for each user would not generalize well in the testing period due to data sparsity. Here, we adopt the decision tree classifier and build a decision tree for each user to model the user-specific relationship between location and service. The model is trained with CART with all default parameters.

Temporal Model: Unlike spatial features where the location of a POI is typically fixed, the temporal distribution of the requests suffers less from sparsity. Therefore, we adopt a Gaussian Mixture Model approach. Exploratory analysis suggests that k = 2 com- ponents are enough to capture most of the trips of a service used by a user. Note that for the time of the day, 23:59 is very close to 00:01, such variables are called circular quantities [3]. We adapt the approach reported in [8] to calculate the mean and variance of the distribution, and we modify the traditional GMM accordingly to account for the circular quantities.

### 4.3 Ensemble Model

So far, we have introduced several different models, each of which utilizes a particular feature: The Markov model utilizes the sequen- tial feature, the Spatial model utilizes the spatial feature, and the Temporal utilizes the temporal features. These models allow us to measure how much improvement each feature brings, however different users may benefit from different models since their pref- erence may be more correlated with some features than others. It is desirable to have one unified model that combine all features.

Ensemble: The three models, namely Markov, Spatial, and Tem- poral vote on their best guesses with equal weight and the service with the most vote is the final prediction. In case of tie (all three models predicts differently), the prediction from Spatial model is chosen.

## Evaluation

Since the prediction task is a classic multi-class classification prob- lem, we would use accuracy as the evaluation metric. However, since more than 70% trips are made with Express, the classification task suffers from imbalanced data. Therefore, we will also report the macro-F1 score, in order to make sure the classifier is fair to all services. This is crucial in assuring the product team to adopt our model without harming any particular line-of-business.

## Future Research

Adding More Features: Our model can greatly benefit from in- cluding more features. For example, the type of the origin POI (business, residential, shopping, etc.) would allow us to better understand the purpose of the trip, which translates into the preferred line-of-business. 

Counting for the Supply: So far, our analysis focuses only on the demand (passenger) side of the ride sharing. Yet the supply (driver/vehicle) side can also affect users’ choice. For example, many drivers only work as Express drivers during the weekend. Thus, an experienced user knowing such supply pattern would avoid requesting Express on weekdays. 

Controlling Other Contexts: Other contexts may potentially affect the user’s choice. For example, the coupons and promotions
provide provide strong incentives for the users to choose a certain service. For another example, the “default” option offered by the system could also affect the user’s preference without the user knowing it. The current app interface implements a Last Used model as the default choice. Could that be the reason why the Last Used works well for inactive users? We plan to explore these in our future work.