---
layout: post
title: 【Method】回归分析基础（六）多元回归分析有效性的评估
categories: Analytics
---

本章将研究多元回归分析在什么情况下是可靠的，而在什么情况下是不可靠的。我们将集中讨论旨在估计解释变量变化对被解释变量的因果效应的统计分析，我们要了解多元回归分析给出的因果效应估计在什么情况下是有效的，什么情况下是无效的。

本章将介绍评估统计有效性的一般框架，这一框架适用于回归分析，也适用于其他分析。该框架是建立在内部有效性和外部有效性的概念基础上。如果某项研究关于因果效应的统计推断对所研究的总体及环境是有效的，则称其具有内部有效性；如果某项研究的统计推断可以推广到其他总体及环境中，则称其具有外部有效性。

## 内部有效性和外部有效性

如果某项研究关于因果关系的统计推断对所研究的总体是有效的，则称其具有内部有效性（internal validity）。如果统计推断及结论可以推广到其他总体及环境中，则称其具有外部有效性（external validity）。

内部有效性和外部有效性将我们所研究的总体及环境与（欲将研究结论推广到）其他总体及环境做了区分。其中，研究的总体（population studied）是指从中抽样的个人、公司或学区等总体。结论可推广到其他总体，或感兴趣的总体（population of interest），即我们意将研究所得到的因果推断推广到的总体。例如，某中学（9~12年级）校长想把我们关于加利福利亚小学学区（研究总体）班级规模和测试成绩的结论推广到中学总体（感兴趣的总体）中。

这里的“环境”是指制度、法律、社会和经济环境。例如，在实验室内评估的有机番茄种植方法的结论能否推广到田间，即在实验室环境中有效的有机种植方法能否在现实世界环境中发挥同样的效果，了解这一点是很重要的。

### 内部有效性的威胁

内部有效性由两部分组成。第一，因果效应的估计量应该是无偏和一致的。

第二，假设检验应该具有合意的显著性水平（在原假设下，被拒绝的实际概率应该等于合意的显著性水平），置信区间也应该具有合意的置信水平。

在回归分析中，因果效应是通过估计回归函数得到的，而假设检验是基于估计的回归系数及其标准误差来进行的。相应地，在基于OLS回归的研究中，内部有效性要求OLS估计量是无偏和一致的，同时要求计算的标准误差要使置信区间具有合意的置信水平。然而，存在各种各样的原因会使上述条件无法成立，这些原因便构成了内部有效性的威胁。这些威胁导致一个或多个最小二乘条件不成立。例如，我们详细讨论过的遗漏变量偏差问题就是一个威胁，它会导致一个或多个回归变量与误差项相关，从而违背了第一个最小二乘假设。如果能够获得遗漏变量或控制变量的数据，则我们可以通过在回归中加入这些变量从而避免遗漏变量偏差带来的威胁。

### 外部有效性的威胁

外部有效性的潜在威胁来自研究总体及环境和感兴趣的总体及环境之间的差异。

总体间的差异。研究总体和感兴趣的总体之间的差异构成了外部有效性的威胁。例如，实验室中通常利用像老鼠这样的动物总体（研究总体）来研究化学药品的毒性，但其结果却被用来制定人类（感兴趣的总体）的健康和安全准则。老鼠和人类之间的差异是否足够大，以致威胁到此类研究的外部有效性，这仍存在争议。

一般而言，研究总体的真实因果效应与感兴趣的总体的真实因果效应可能不同，这可能是因为所研究总体的选取方法使其与感兴趣的总体出现差异，或因为总体特征不同，或因为地理位置不同，又或是因为研究已经过时。

环境的差异。即使研究总体和感兴趣的总体完全相同，但如果环境存在差异，也可能无法推广研究结果。例如，如果两所大学对酗酒的惩罚措施不同，即使两所大学的学生总体相同，也不能将其中一所大学的反酗酒宣传活动对大学生酗酒的效应推广到另一所大学。在这个例子中，研究所处的法律环境与研究结论欲推广到的法律环境是不同的。

一般而言，环境差异的例子包括制度环境的差异（如公立大学和宗教大学）、法律的差异（如法律制裁的差异）或自然环境的差异。

感兴趣的总体及环境与研究总体及环境越接近，则越可能具有外部有效性。

如何评估一项研究的外部有效性。外部有效性评估必须借助对研究总体及环境和感兴趣的总体及环境的具体了解。如果二者之间存在显著差异，则研究的外部有效性就值得怀疑。

有时，围绕不同但相关的总体会存在两个或多个相似研究。如果是这样的话，我们可以通过比较两个研究结果来检验它们的外部有效性。一般来说，两个或多个研究结论相似，则支持外部有效性，但如果这些结论存在无法解释的差异，则我们有理由怀疑其外部有效性。

如何设计具有外部有效性的研究。由于外部有效性的威胁来源于总体及环境缺乏可比性，所以最好在收集数据之前，即研究初期就尽量降低这些威胁。

## 多元回归分析的内部有效性威胁

本节将讨论造成多元回归系数的OLS估计量在大样本下仍然有偏的五个原因，即遗漏变量、回归函数形式的误设、解释变量测量偏误（“变量误差”）、样本选取及双向因果关系。这五个偏差产生的原因都是由于回归模型中解释变量与误差项相关，从而违背了第一个最小二乘假设。这里将针对每一个原因讨论如何缩小偏差，本节最后将讨论导致标准误差非一致的情况及其处理办法。

### 遗漏变量偏差

由之前的讨论可知，如果回归中遗漏了某个影响Y且与一个或多个解释变量相关的变量时，就会产生遗漏变量偏差。即使在大样本下，这一偏差仍然存在，故OLS估计量是非一致的。如何尽量减少遗漏变量偏差，则取决于我们是否能够获得潜在遗漏变量的数据。

当遗漏变量可观测或有足够的控制变量时，遗漏变量偏差的解决方法。如果你有遗漏变量的数据，那么在多元回归模型中加入该变量便可解决遗漏变量偏差问题。或者，如果你有一个或多个控制变量的数据，且这些控制变量是足够的，即能够保证条件均值独立假设成立，则加入这些控制变量便可消除感兴趣变量系数的潜在偏差。

在回归中加入新的变量由好处也有坏处。一方面，遗漏变量可能导致遗漏变量偏差；另一方面，如果加入了不该回归的变量（即其总体回归系数为零），则会降低其他回归系数估计量的精确度。换句话说，是否要加入该变量取决于感兴趣系数估计量的偏差和方差之间的权衡。在实际应用中，以下四个步骤可以帮助你决定在回归中是否应该加入某个或多个变量。

第一步：确定回归中的主要系数或感兴趣的系数。在测试成绩的回归中，由于一开始提出的问题是关于降低学生-教师比对测试成绩产生的影响，所以学生-教师比的系数是我们感兴趣的系数。

第二步：考虑该回归中的遗漏变量偏差最可能来源于哪里？回答这一问题需要运用经济理论和专业知识，而且应该在建立回归之前就加以考虑。由于这一步是在分析数据之前进行的，故也称之为先验（“事实之前”）推理。在测试成绩的例子中，这一步要求确定测试成绩的决定因素，如果忽略这些因素会导致班级规模效应估计量有偏。由此，我们可以得到回归的基本设定形式，这也是实证分析的出发点，同时也得到了有助于减少遗漏变量偏差的“可疑”变量。

第三步：利用第二步中确定的可疑控制变量扩展基本设定形式。如果新加入的控制变量系数统计上显著，或当加入这些变量后感兴趣的系数估计值明显改变，则回归中应该保留这些变量，于是需要修改基本设定形式。反之，则应该在回归中去掉这些变量。

第四步：以列表形式给出你的详细估计结果，为持有怀疑精神的读者“充分揭示”你所掌握的信息，以便于他们可以从中去推导自己关心的结论。

当有效控制变量不可观测时，遗漏变量偏差的解决办法。如果你没有关于遗漏变量或其他有效控制变量的数据，则在回归中加入这些变量的方法就不可行。尽管如此，还是有三种解决遗漏变量偏差的方法。这三种方法都是通过采用不同类型的数据来避免遗漏变量偏差。

第一种方法是利用同一组个体在不同时间点的观测数据。例如，我们收集到了两组数据，分别是同一学区在1995年和2000年的测试成绩和相关变量的数据。这种形式的数据称为面板数据。只要这些遗漏变量不随时间而变化，则利用面板数据就可以控制这些不可观测的遗漏变量。

第二种方法是利用工具变量回归。该方法依赖于一个称为工具变量的新变量。

第三章方法是利用研究设计，即利用随机对照实验去分析感兴趣的效应（如缩小班级规模对学生测试成绩的影响）。

### 回归函数形式的误设

如果真实的回归函数是非线性的，但我们估计的却是线性回归模型，则这种函数形式误差（functional form misspecification）将会导致OLS估计量有偏。 这种偏差也是一种遗漏变量偏差，其中的遗漏变量是指能反映回归函数中缺少的非线性部分的信息的变量。例如，如果真实的回归函数为二次多项式，则在回归中遗漏解释变量的二次项将会导致遗漏变量偏差。

函数形式误设的解决方法。当被解释变量连续时（如测试成绩），可以利用非线性模型的方法解决这种潜在的非线性问题。然而，如果被解释变量是离散的或二元的，则情况会变得更复杂。我们将在后续章节讨论离散型被解释变量的回归。

### 测量误差和变量的测量偏误

假设在测试成绩对学生-教师比的回归中，我们不小心弄混了数据，得到了学区内五年级的测试成绩对十年级的学生-教师比的回归。虽然五年级的学生-教师比和十年级的学生-教师比相关，但它们仍是不同的，故这一混淆会导致系数估计量的有偏性。由于这种偏差来源于解释变量的测量误差，所以称其为变量的测量偏误（errors-in-variable bias）。即使在大样本下这一偏差仍然存在，所以当存在测量误差时，OLS估计量是非一致的。

导致测量误差的原因有很多。如果数据是通过调查得到的，则受访者给出的答案可能并不真实。例如，《当前人口调查》中有一个问题是关于去年的收入，某受访者可能不知道他的确切收入或由于其他原因而没有正确回答。另外，如果数据来源于官方电子记录，也可能存在数据首次输入时的录入错误。

为了了解变量的测量误差如何导致解释变量与误差项相关，我们假设回归中只有一个解释变量$$X_i$$（如实际收入），但其被误测为$$\tilde{X}_i$$（受访者给出的收入）。由于观测到的是$$\tilde{X}_i$$而不是$$X_i$$，所以回归方程实际上是基于$$\tilde{X}_i$$估计得到的。用误测的变量$$\tilde{X}_i$$表示总体回归方程$$Y_i=\beta_0 + \beta_1 X_i + u_i$$，得到

$$Y_i = \beta_0 + \beta_1 \tilde{X}_i + [\beta_1(X_i - \tilde{X}_i) + u_i] = \beta_0 + \beta_1 \tilde{X}_i + v_i$$

其中，$$v_i = \beta_1 (X_i - \tilde{X}_i) + u_i$$。因此，用$$\tilde{X}_i$$作为解释变量的回归方程的误差项中包含了测量误差，即$$\tilde{X}_i$$与$$X_i$$的差值。如果这个差值与误测值$$\tilde{X}_i$$相关，则回归变量$$\tilde{X}_i$$与误差项相关，从而