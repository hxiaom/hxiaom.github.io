---
layout: post
title: 【Method】回归分析基础（二）一元线性回归：假设检验和置信区间
categories: Analytics
---

## 关于某个回归系数的假设检验

一般来说，t统计量具有如下形式

$$t = \frac{估计量-假设值}{估计量的标准误差}$$

### $$\beta_1$$的双边假设

对系数$$\beta_1$$进行假设检验的一般方法与对总体均值进行假设检验的方法相同。因此我们首先回归一下关于总体均值的检验

Y的均值等于某一特定值$$\mu_{Y,0}$$的原假设可以表示为$$H_0: E(Y) = \mu_{Y,0}$$，而双边备择假设为$$H_1: E(Y) \neq \mu_{Y,0}$$。

对原假设$$H_0$$的检验可以按照三个步骤进行。第一步是计算$$\bar{Y}$的标准误差$$SE(\bar{Y})$$，它是$$\bar{Y}$$抽样分布标准差的估计量；第二步是计算t统计量；第三步是计算p值，它是基于实际观测到的检验统计量得到的能够拒绝原假设的最低显著性水平。

斜率$$\beta_1$$的假设检验。从理论上讲，上述关于总体均值的检验过程准确有效的关键之处在于：在大样本下，$$\bar{Y}$$的抽样分布是渐近正态的。因为在大样本中，$$\hat{\beta}_1$$也服从正态分布，所以我们也可以利用上述方法来检验关于斜率$$\beta_1$$真值的假设。

在进行检验之前，我们需要明确列示出原假设和备择假设，如原假设为解释变量对被解释变量无影响$$\beta_1=0$$。更一般地，原假设是总体斜率$$\beta_1$$的真值等于某个特定值$$\beta_{1,0}$$，双边备择假设为$$\beta_1$$不等于$$\beta_{1,0}$$。即原假设和双边备择假设分别为：

$$H_0: \beta_1 = \beta_{1,0}  and H_1: \beta_1 \neq \beta_{1,0}$$

为了检验原假设$$H_0$$，我们采用与总体均值检验相同的三个步骤。

第一步，计算$$\hat{\beta}_1$$的标准误差$$SE(\hat{\beta}_1)$$。它是$$\hat{\beta}_1$$的抽样分布的标准差$$\sigma_{\hat{\beta}_1}$$的估计量。具体地

$$SE(\hat{\beta}_1) = \sqrt{\sigma_{\hat{\beta}_1}^2}$$

其中

$$\sigma_{\hat{\beta}_1}^2 = \frac{1}{n} \times \frac{\frac{1}{n-2} \sum_{i=1}^n (X_i - \bar{X})^2 \hat{u}_i^2}{[\frac{1}{n} \sum_{i=1}^n (X_i - \bar{X})^2]}$$

尽管$$\sigma_{\hat{\beta}_1}^2$$的公式很复杂，但在实际应用中我们通常利用回归软件来计算，所以使用起来比较容易。

第二步，计算t统计量

$$t = \frac{\hat{\beta}_1 - \beta_{1,0}}{SE(\hat{\beta}_1)}$$

第三步，计算p值，即在原假设成立的条件下，得到与$$\beta_{1,0}$$距离至少和实际计算的估计值$$\hat{\beta}_1^{act}$$与$$\beta_{1,0}$$的距离相同的$$\hat{\beta}_1$$的概率。其数学表达式为

$$\begin{align}
p-value &= P_{H_0} [\mid \hat{\beta}_1 - \beta_{1,0} \mid > \mid \hat{\beta}_1^{act} - \beta_{1,0} \mid] \
&= P_{H_0} [\mid \frac{\hat{\beta}_1 - \beta_{1,0}}{SE(\hat{\beta}_1)} \mid > \mid \frac{\hat{\beta}_1^{act} - \beta_{1,0}}{SE(\hat{\beta}_1)} \mid] \
&= P_{H_0} (\mid t \mid > \mid t^{act} \mid) \
\end{align}$$

其中，$$P_{H_0}$$表示在原假设成立的条件下计算得到的概率，第二个等式是由上式同除以$$SE(\hat{\beta}_1)$$得到的。因为在大样本下$$\hat{\beta}_1$$服从渐近正态分布，因此在原假设下，t统计量近似服从标准正态分布，故在大样本下有

$$p-value = P(\mid Z \mid > \mid t^{act} \mid) = 2 \phi (- \mid t^{act} \mid)$$

若p值小于5%，则意味着在原假设下，得到至少和实际观测值与原假设距离相同的$$\hat{\beta}_1$$值的概率小于5%，从而提供了反对原假设的证据，即在5%的显著性水平下拒绝原假设。

另一种方法是在5%的显著性水平下，只需比较t统计量的绝对值和双边检验的临界值1.96就可以检验原假设，若$$\mid t^{act} \mid >1.96$$，则在5%的显著性水平下拒绝原假设。

### $$\beta_1$$的单边假设

有时候使用单边假设检验更合适也更有意义。

对于单边检验，其原假设和单边备择假设分别为：

$$H_0: \beta_1 = \beta{1.0} and H_1: \beta_1 < \beta_{1,0}$$

因为单边和双边假设检验的原假设均相同，故t统计量的构造也一样。两者之间的唯一区别在于如何解释t统计量。

单边检验的p值可以通过标准正态分布的累积分布函数得到，即

$$p-value = P(Z < t^{act}) = \phi (t^{act}) (p值，单边左尾检验）$$

如果备择假设为$$\beta_1$$大于$$\beta_{1,0}$$，则上式不等号方向相反，故p值为右尾概率$$P(Z > t^{act})$$。

什么时候使用单边检验？在实际应用中，只有存在明确的理由时，我们才使用单边备择假设。这个理由可能来自经济理论、先验证据或者二者皆有。然而，即使一开始认为相关备择假设可能是单边的，但仔细考虑后却未必如此。

### 截距$$\beta_0$$的假设检验

我们偶尔也会关心截距$$\beta_0$$的假设检验。关于截距的原假设和双边备择假设分别为

$$H_0: \beta_0 = \beta_{0,0}; H_1: \beta_0 \neq \beta_{0,0}$$

检验这一原假设的一般方法是将上节中的三个步骤应用于$$\beta_0$$。

如果你脑海中有一个原假设，则假设检验是很有用的。基于统计证据接受或拒绝原假设的方法，为我们提供了利用样本了解总体时处理内在不确定性的强大工具。然而，很多时候我们并不知道回归系数对于的具体假设是什么，于是我们需要了解回归系数的取值区间，即需要构造置信区间。


## 回归系数的置信区间

由于斜率$$\beta_1$$的任何估计结果都存在不确定性，因此我们不能仅通过一组样本数据来准确推测$$\beta_1$$的真值。然而，我们可以利用OLS估计量及其标准误差来构造斜率$$\beta_1$$或截距$$\beta_0$$的置信区间。

$$\beta_1$$的置信区间。$$\beta_1$$的95%置信区间（confidence interval）有两个等价的定义。其一是在5%的显著性水平下利用双边假设检验不能拒绝的$$\beta_1$$的取值集合。其二是以95%的概率包含$$\beta_1$$真值的区间，即抽取的可能样本中有95%的样本构造的置信区间中包含了$$\beta_1$$的真值。因为在95%的所有样本的置信区间中都包含了真值，故称其具有95%的置信水平（confidence level）。

这两个定义等价的原因是：根据定义，5%的显著性水平下的假设检验只能在5%的所有可能样本中拒绝$$\beta_1$$的真值，即在95%的所有可能样本中不会拒绝$$\beta_1$$的真值。