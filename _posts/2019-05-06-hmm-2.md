---
layout: post
title: 【Method】HMM（二）概率计算问题
categories: Analytics
---

## 原理

概率计算问题。给定模型$$\lambda=(A,B,\pi)$$和观测序列$$O=(o_1, o_2,...,o_T)$$，计算在模型$$\lambda$$下观测序列O出现的概率$$P(O \mid \lambda)$$。

### 直接计算法

给定模型$$\lambda=(A,B,\pi)$$和观测序列$$O=(o_1, o_2,...,o_T)$$，计算在模型$$\lambda$$下观测序列O出现的概率$$P(O \mid \lambda)$$。最直接的方法是按概率公式直接计算。通过列举所有可能的长度为T的状态序列$$I=(i_1, i_2,...,i_T)$$，求各个状态序列I与观测序列$$O=(o_1, o_2,...,o_T)$$的联合概率$$P(O, I \mid \lambda)$$，然后对所有可能的状态序列求和，得到$$P(O \mid \lambda)$$。

状态序列$$I=(i_1, i_2, ..., i_T)$$的概率是

$$P(I \mid \lambda) = \pi_{i_1} a_{i_1 i_2} a_{i_2 i_3} ... a_{i_{T-1} i_T}$$

对固定的状态序列$$I=(i_1, i_2, ..., i_T)$$，观测序列$$O=(o_1, o_2,...,o_T)$$的概率是$$P(O \mid I, \lambda)$$

$$P(O \mid I, \lambda) = b_{i_1}(o_1) b_{i_2}(o_2) ... b_{i_{i_T}}(o_T)$$

O和I同时出行的联合概率为

$$
