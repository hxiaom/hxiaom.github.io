---
layout: post
title: 【Method】回归分析专题（四）实验和准实验
categories: Analytics
---

在很多领域，如心理学和医学领域，人们普遍使用实验方法来估计因果效应。在一种新药被批准大量使用之前，通常会进行实验，实验人员会随机选择一些病人，使其接受这种药物治疗，同时随机选择另外一些病人，接受一种无害且没有治疗作用的替代物（一种“安慰剂”）的治疗。只有当这种随机对照实验能够提供令人信服的统计证据，证明这种药是安全且有效时，这种药才会被批准广泛使用。

为什么要在计量经济学课程中学习随机对照实验？主要有三个理由：第一，理想化的随机对照实验提供了一种基准，当我们用可观测的数据来估计因果效应时，可以依据这一基准来判断估计的合理性；第二，当我们进行随机对照实验时，实验结果具有重要的影响，所以，理解实验的局限性和有效性威胁，与理解实验的优点是同等重要的；第三，外部环境有时能够提供一种随机化的环境，换言之，由于发生某一外部事件，一些个体得到了处理，并且这些处理“似乎”是随机实施的，或者这一随机性可能是以一些控制变量为条件的。这种“似乎”随机性提供了一种“准实验”或“自然实验”。此时，许多用于随机对照实验的分析方法（经过一些修正）可以用于分析准实验。

本章主要讨论经济学中的实验和准实验。本章用到的统计工具包括多元线性回归、面板数据回归及工具变量回归。本章与其他章节的不同之处并不在于所使用的工具，而在于所分析的数据类型，以及分析实验和准实验时遇到的特殊机会和挑战。

本章提到的方法经常被用于经济社会中的项目评估。项目评估主要是分析项目效果、政策效果，以及某些其他类型的介入或处理的效果。在本章，我们将讨论如何运用实验或准实验方法来评估这些项目。

## 潜在结果、因果效应和理想化实验

本节将解释如何运用随机对照实验来估计个体水平因果效应的总体均值，以及如何运用多元回归分析工具分析这类实验中的数据。

### 潜在结果和平均因果效应

一个潜在结果（potential outcome）就是一个个体在潜在处理下得到的结果。这一个体的因果效应是接受处理和不接受处理的潜在结果之间的差异。一般而言，个体的因果效应可以随个体的不同而不同。例如，药物治疗的效果可能与你的年龄、是否吸烟或者其他健康状况有关。问题在于，我们无法对一个单个个体的因果效应进行度量。因为，一个个体要么接受了处理，要么没有接受处理，我们只能观测到这两个潜在结果中的某一个，而无法同时观测到两个潜在结果。

尽管一个单个个体的因果效应无法度量，但在许多应用中，我们只需要知道总体的平均因果效应就已经足够。例如，在评估职业培训项目时，我们只需要权衡受训者的平均花费和受训者找到工作的平均成功次数。我们所研究的个体因果效果的总体均值被称为平均因果效应（average causal effect）或平均处理效应（average treatment effect）。

我们可以利用理想化的随机对照实验，来估计一个给定总体的平均因果效应。如何能够做到这一点呢？

首先假设研究对象是从我们所研究的总体中随机抽取的。因为这些研究对象是通过简单随机抽样选取，他们的潜在结果及因果效应都来自相同的分布，所以，样本因果效应的期望值就是总体的平均因果效应。紧接着，我们假设，这些研究对象被随机分配到处理组或对照组。因为个体的处理状态是随机分配的，个体的处理状态与他/她的潜在结果便是相互独立的。因此，接受处理的期望结果与没有接受处理的期望结果的差值就是因果效应的期望值。因此，当满足以下两个条件：（1）从总体中抽取样本；（2）将个体随机分配到处理组与对照组，则处理组和对照组的潜在结果差异的期望值就是总体的平均因果效应。相对于不处理（$$X_i=0$$），处理（$$X_i=1$$）对$$Y_i$$产生的因果效应等于条件期望之差$$E(Y_i \mid X_i = 1) - E(Y_i \mid X_i = 0)$$，$$E(Y_i \mid X_i = 1)$$和$$E(Y_i \mid X_i = 0)$$分别表示理想化随机对照实验中处理组和对照组Y的期望值。

一般而言，个体因果效应可能同时依赖于可观测变量和不可观测变量。我们前文已经遇到过因果效应依赖于可观测变量的情况。本章的大部分内容将聚焦在仅仅依赖可观测变量的因果效应方面，而第6小节将把不可观测的异质性纳入因果效应的讨论中。

### 分析实验数据的计量经济学方法

我们可以通过比较均值的差异，或者使用一个包含用以表达是否接受处理的示性函数和其他控制变量的回归方程来分析随机对照实验的数据。在后一种设定中，带控制变量的差役估计量可以被用于更加复杂的随机化方案中，即随机性依赖于可观测的协变量。

差异估计量。差异估计量（differences estimator）是指处理组和对照组的样本均值之差，可以通过将结果变量Y对二元处理变量X（用以表示是否接受处理的二元变量）进行回归得到：

$$Y_i = \beta_0 + \beta_1 X_i + u_i, i=1,...,n$$

如果X是随机分配的，则$$E(u_i \mid X_i)=0$$，此时上式中的$$\beta_1$$的OLS估计量是因果效应的无偏且一致估计量。

带附加解释变量的差异估计量。我们可以通过在回归方程中加入控制变量W来提高差异估计量的有效性，即得到带附加解释变量的差异估计量：

$$Y_i = \beta_0 + \beta_1 X_i + \beta_2 W_{1i} + ... + \beta_{1+r} W_{ri} + u_i, i=1,...,n$$

如果W对Y有解释作用，则加入W会降低回归的标准差，通常也会降低$$\beta_1$$估计量的标准差。为了使上式中的因果效应$$\beta_1$$的估计量无偏，必须满足以下的条件均值独立假设，即$$E(u_i \mid X_i, W_i) = E(u_i \mid W_i)$$。如果$$W_i$$是前处理（pretreatment）特征变量（如性别），且$$X_i$$是随机分配的，则$$X_i$$独立于$$u_i$$和$$W_i$$，满足$$E(u_i \mid X_i, W_i) = E(u_i \mid W_i)$$。上式中的解释变量W不能包括实验结果（给定实验结果，$$X_i$$不是随机分配的）。与通常情况一样，即使在条件均值独立的条件下，控制变量的系数也没有因果效应的含义。

估计依赖于观测值的因果效应。若因果效应的大小依赖于观测值，则可以通过在回归方程中加入$$X_i$$的非线性函数或$$X_i$$的交叉项来估计。例如，如果$$W_{1r}$$是一个表示性别的二元示性函数，则男性和女性不同的因果效应可以通过在回归方程中加入交叉项$$W_{1r} \times X_i$$而进行估计。

基于协变量的随机化。若分配到处理组的概率依赖于一个或多个可观测变量W，则这一随机化被称作基于协变量的随机化（randomization based on covariates）。如果随机化依赖于协变量，则一般而言，上式的差异估计量存在遗漏变量偏差。因为给定$$W_i, X_i$$是随机分配的，所以这一遗漏变量偏差可以通过估计加入控制变量$$W_i$$后的带附加解释变量的差异估计量来解决。给定$$W_i, X_i$$的随机分配特征（结合线性回归方程的假设）隐含着，给定$$W_i, X_i$$在上式中独立于$$u_i$$。条件独立性反过来又隐含着条件均值的独立性，即$$E(u_i \mid X_i, W_i) = E(u_i \mid W_i)$$。因此，在上式中，当$$X_i$$是基于$$W_i$$随机分配时，OLS估计量$$\hat{beta}_1$$是因果效应的无偏估计量。

## 实验的有效性威胁

对所研究的总体而言，如果关于因果效应的统计推断是有效的，则称这一统计研究是内部有效的。当统计推断及其结论能推广到其他总体和环境时，则称这一统计研究是外部有效的。当我们在借助以人为研究对象的实验进行分析时，现实中的很多问题会给这一分析的内部有效性和外部有效性带来威胁。

### 内部有效性威胁

随机对照实验的内部有效性威胁包括未能完全随机分组、没有遵循处理协议、中途退出实验、实验效应和样本过小。